<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Troubleshooting | MARSS R Package</title>
  <meta name="description" content="This is the online manual for the MARSS R package. It covers the package functions, input and output, residuals, prediction, error messages and troubleshooting. For vignettes showing different applications of MARSS models, including Dynamic Factor Analysis and Dynamic Linear Models, please see the companion book MAR Modeling for Environmenal Science by Holmes, Scheuerell and Ward." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Troubleshooting | MARSS R Package" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="This is the online manual for the MARSS R package. It covers the package functions, input and output, residuals, prediction, error messages and troubleshooting. For vignettes showing different applications of MARSS models, including Dynamic Factor Analysis and Dynamic Linear Models, please see the companion book MAR Modeling for Environmenal Science by Holmes, Scheuerell and Ward." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Troubleshooting | MARSS R Package" />
  
  <meta name="twitter:description" content="This is the online manual for the MARSS R package. It covers the package functions, input and output, residuals, prediction, error messages and troubleshooting. For vignettes showing different applications of MARSS models, including Dynamic Factor Analysis and Dynamic Linear Models, please see the companion book MAR Modeling for Environmenal Science by Holmes, Scheuerell and Ward." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Elizabeth E. Holmes, Eric J. Ward, Mark D. Scheuerell, and K. Wills" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="part4.html"/>
<link rel="next" href="chap-algorithm-notes.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MARSS Package Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="authors.html"><a href="authors.html"><i class="fa fa-check"></i>Authors</a></li>
<li class="chapter" data-level="" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i>Citation</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li><a href="part1.html#part1"><i style="font-size: 110%; color:#990017;">Part 1. Overview</i></a></li>
<li class="chapter" data-level="1" data-path="chap-overview.html"><a href="chap-overview.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="marss-model-form.html"><a href="marss-model-form.html"><i class="fa fa-check"></i><b>1.1</b> MARSS model form</a></li>
<li class="chapter" data-level="1.2" data-path="example-model.html"><a href="example-model.html"><i class="fa fa-check"></i><b>1.2</b> Example model</a></li>
<li class="chapter" data-level="1.3" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>1.3</b> Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-quick-start.html"><a href="chap-quick-start.html"><i class="fa fa-check"></i><b>2</b> Quick Start</a>
<ul>
<li class="chapter" data-level="2.1" data-path="model-specification.html"><a href="model-specification.html"><i class="fa fa-check"></i><b>2.1</b> Model specification</a></li>
<li class="chapter" data-level="2.2" data-path="linear-constraints.html"><a href="linear-constraints.html"><i class="fa fa-check"></i><b>2.2</b> Linear constraints</a></li>
<li class="chapter" data-level="2.3" data-path="time-varying-parameters.html"><a href="time-varying-parameters.html"><i class="fa fa-check"></i><b>2.3</b> Time-varying parameters</a></li>
<li class="chapter" data-level="2.4" data-path="inputs-c-and-d.html"><a href="inputs-c-and-d.html"><i class="fa fa-check"></i><b>2.4</b> Inputs <code>c</code> and <code>d</code></a></li>
<li class="chapter" data-level="2.5" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html"><i class="fa fa-check"></i><b>2.5</b> Tips and Tricks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-input.html"><a href="chap-input.html"><i class="fa fa-check"></i><b>3</b> Data format</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ts-objects.html"><a href="ts-objects.html"><i class="fa fa-check"></i><b>3.1</b> <code>ts</code> objects</a></li>
<li class="chapter" data-level="3.2" data-path="tsibble-objects.html"><a href="tsibble-objects.html"><i class="fa fa-check"></i><b>3.2</b> <code>tsibble</code> objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-model-list.html"><a href="chap-model-list.html"><i class="fa fa-check"></i><b>4</b> Model specification</a>
<ul>
<li class="chapter" data-level="4.1" data-path="general-matrix-specification.html"><a href="general-matrix-specification.html"><i class="fa fa-check"></i><b>4.1</b> General matrix specification</a></li>
<li class="chapter" data-level="4.2" data-path="linear-constraints-1.html"><a href="linear-constraints-1.html"><i class="fa fa-check"></i><b>4.2</b> Linear constraints</a></li>
<li class="chapter" data-level="4.3" data-path="time-varying-parameters-1.html"><a href="time-varying-parameters-1.html"><i class="fa fa-check"></i><b>4.3</b> Time-varying parameters</a></li>
<li class="chapter" data-level="4.4" data-path="examples-for-each-parameter.html"><a href="examples-for-each-parameter.html"><i class="fa fa-check"></i><b>4.4</b> Examples for each parameter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-covariates.html"><a href="chap-covariates.html"><i class="fa fa-check"></i><b>5</b> Covariates format</a></li>
<li><a href="part2.html#part2"><i style="font-size: 110%; color:#990017;">Part 2. Short Examples</i></a></li>
<li class="chapter" data-level="6" data-path="chap-short-output.html"><a href="chap-short-output.html"><i class="fa fa-check"></i><b>6</b> Common output for fits</a></li>
<li class="chapter" data-level="7" data-path="chap-uss.html"><a href="chap-uss.html"><i class="fa fa-check"></i><b>7</b> Univariate Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="random-walk-with-drift.html"><a href="random-walk-with-drift.html"><i class="fa fa-check"></i><b>7.1</b> Random walk with drift</a></li>
<li class="chapter" data-level="7.2" data-path="random-walk-with-time-varying-parameters.html"><a href="random-walk-with-time-varying-parameters.html"><i class="fa fa-check"></i><b>7.2</b> Random walk with time-varying parameters</a></li>
<li class="chapter" data-level="7.3" data-path="ar1-observed-with-error.html"><a href="ar1-observed-with-error.html"><i class="fa fa-check"></i><b>7.3</b> AR(1) observed with error</a></li>
<li class="chapter" data-level="7.4" data-path="linear-regression-lr.html"><a href="linear-regression-lr.html"><i class="fa fa-check"></i><b>7.4</b> Linear regression (LR)</a></li>
<li class="chapter" data-level="7.5" data-path="lr-with-ar1-errors.html"><a href="lr-with-ar1-errors.html"><i class="fa fa-check"></i><b>7.5</b> LR with AR(1) errors</a></li>
<li class="chapter" data-level="7.6" data-path="lr-with-ar1-errors-and-independent-errors.html"><a href="lr-with-ar1-errors-and-independent-errors.html"><i class="fa fa-check"></i><b>7.6</b> LR with AR(1) errors and independent errors</a></li>
<li class="chapter" data-level="7.7" data-path="lr-with-ar1-errors-driven-by-covariate.html"><a href="lr-with-ar1-errors-driven-by-covariate.html"><i class="fa fa-check"></i><b>7.7</b> LR with AR(1) errors driven by covariate</a></li>
<li class="chapter" data-level="7.8" data-path="flat-level-model.html"><a href="flat-level-model.html"><i class="fa fa-check"></i><b>7.8</b> Flat level model</a></li>
<li class="chapter" data-level="7.9" data-path="linear-trend-model.html"><a href="linear-trend-model.html"><i class="fa fa-check"></i><b>7.9</b> Linear trend model</a></li>
<li class="chapter" data-level="7.10" data-path="stochastic-level-model.html"><a href="stochastic-level-model.html"><i class="fa fa-check"></i><b>7.10</b> Stochastic level model</a></li>
<li class="chapter" data-level="7.11" data-path="stochastic-slope-model.html"><a href="stochastic-slope-model.html"><i class="fa fa-check"></i><b>7.11</b> Stochastic slope model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap-marss.html"><a href="chap-marss.html"><i class="fa fa-check"></i><b>8</b> Multivariate Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rw-observed-with-multiple-time-series.html"><a href="rw-observed-with-multiple-time-series.html"><i class="fa fa-check"></i><b>8.1</b> RW observed with multiple time series</a></li>
<li class="chapter" data-level="8.2" data-path="multiple-time-series-each-observing-a-rw.html"><a href="multiple-time-series-each-observing-a-rw.html"><i class="fa fa-check"></i><b>8.2</b> Multiple time series each observing a RW</a></li>
<li class="chapter" data-level="8.3" data-path="different-time-series-observing-a-rw.html"><a href="different-time-series-observing-a-rw.html"><i class="fa fa-check"></i><b>8.3</b> Different time series observing a RW</a></li>
<li class="chapter" data-level="8.4" data-path="trend-observed-with-ar1-error.html"><a href="trend-observed-with-ar1-error.html"><i class="fa fa-check"></i><b>8.4</b> Trend observed with AR(1) error</a></li>
<li class="chapter" data-level="8.5" data-path="dynamic-factor-model-with-3-trends.html"><a href="dynamic-factor-model-with-3-trends.html"><i class="fa fa-check"></i><b>8.5</b> Dynamic Factor Model with 3 trends</a></li>
<li class="chapter" data-level="8.6" data-path="linear-constraints-2.html"><a href="linear-constraints-2.html"><i class="fa fa-check"></i><b>8.6</b> Linear constraints</a></li>
</ul></li>
<li><a href="part3.html#part3"><i style="font-size: 110%; color:#990017;">Part 3. Outputs</i></a></li>
<li class="chapter" data-level="9" data-path="chap-params.html"><a href="chap-params.html"><i class="fa fa-check"></i><b>9</b> Parameter estimates</a></li>
<li class="chapter" data-level="10" data-path="chap-states.html"><a href="chap-states.html"><i class="fa fa-check"></i><b>10</b> States and smoothed estimates</a></li>
<li class="chapter" data-level="11" data-path="chap-fitted.html"><a href="chap-fitted.html"><i class="fa fa-check"></i><b>11</b> Model fits</a></li>
<li class="chapter" data-level="12" data-path="chap-residuals.html"><a href="chap-residuals.html"><i class="fa fa-check"></i><b>12</b> Residuals</a></li>
<li class="chapter" data-level="13" data-path="chap-CIs.html"><a href="chap-CIs.html"><i class="fa fa-check"></i><b>13</b> Confidence Intervals</a></li>
<li class="chapter" data-level="14" data-path="chap-predictions.html"><a href="chap-predictions.html"><i class="fa fa-check"></i><b>14</b> Predictions and forecasts</a></li>
<li><a href="part4.html#part4"><i style="font-size: 110%; color:#990017;">Part 4. Tips and Tricks</i></a></li>
<li class="chapter" data-level="15" data-path="chap-troubleshooting.html"><a href="chap-troubleshooting.html"><i class="fa fa-check"></i><b>15</b> Troubleshooting</a></li>
<li class="chapter" data-level="16" data-path="chap-algorithm-notes.html"><a href="chap-algorithm-notes.html"><i class="fa fa-check"></i><b>16</b> Algorithm notes and cautions</a>
<ul>
<li class="chapter" data-level="16.1" data-path="properly-constrained-models.html"><a href="properly-constrained-models.html"><i class="fa fa-check"></i><b>16.1</b> Properly constrained models</a></li>
<li class="chapter" data-level="16.2" data-path="notes-on-the-kalman-filter.html"><a href="notes-on-the-kalman-filter.html"><i class="fa fa-check"></i><b>16.2</b> Notes on the Kalman filter</a></li>
<li class="chapter" data-level="16.3" data-path="notes-on-the-em-algorithm.html"><a href="notes-on-the-em-algorithm.html"><i class="fa fa-check"></i><b>16.3</b> Notes on the EM algorithm</a></li>
<li class="chapter" data-level="16.4" data-path="bias-in-variance-estimates.html"><a href="bias-in-variance-estimates.html"><i class="fa fa-check"></i><b>16.4</b> Bias in variance estimates</a></li>
<li class="chapter" data-level="16.5" data-path="careful-if-specifying-a-prior-on-initial-conditions.html"><a href="careful-if-specifying-a-prior-on-initial-conditions.html"><i class="fa fa-check"></i><b>16.5</b> Careful if specifying a prior on initial conditions</a></li>
<li class="chapter" data-level="16.6" data-path="state-space-form-of-armapq-models.html"><a href="state-space-form-of-armapq-models.html"><i class="fa fa-check"></i><b>16.6</b> State-space form of ARMA(p,q) models</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="chap-other-packages.html"><a href="chap-other-packages.html"><i class="fa fa-check"></i><b>17</b> Other related packages</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li style="font-weight: normal"><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MARSS R Package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap-troubleshooting" class="section level1" number="15">
<h1><span class="header-section-number">Chapter 15</span> Troubleshooting</h1>
<p><em>Tip: Use <code>MARSSinfo()</code> for information on various common error and warning messages.</em></p>
<p>Numerical errors due to ill-conditioned matrices are not uncommon when fitting MARSS models. The Kalman and EM algorithms need inverses of matrices. If those matrices become ill-conditioned, for example all elements are close to the same value, then the algorithm becomes unstable. Warning messages will be printed if the algorithms are becoming unstable and you can set <code>control$trace=1</code>, to see details of where the algorithm is becoming unstable. Whenever possible, you should avoid using shared <span class="math inline">\(\boldsymbol{\pi}\)</span> values in your model. An example of a <span class="math inline">\(\boldsymbol{\pi}\)</span> with shared values is <span class="math inline">\(\boldsymbol{\pi}=\bigl[\begin{smallmatrix} a\\a\\a \end{smallmatrix} \bigr]\)</span>. The way the EM algorithm deals with <span class="math inline">\(\boldsymbol{\Lambda}\)</span> tends to make this case unstable, especially if <span class="math inline">\(\mathbf{R}\)</span> is not diagonal. In general, estimation of a non-diagonal <span class="math inline">\(\mathbf{R}\)</span> is more difficult, more prone to ill-conditioning, and more data-hungry.</p>
<p>You may also see non-convergence warnings, especially if your MLE model turns out to be degenerate. This means that one of the elements on the diagonal of your <span class="math inline">\(\mathbf{Q}\)</span> or <span class="math inline">\(\mathbf{R}\)</span> matrix are going to zero (are degenerate). It will take the EM algorithm forever to get to zero. BFGS will have the same problem, although it will often get a bit closer to the degenerate solution. If you are using <code>method="kem"</code>, MARSS will warn you if it looks like the solution is degenerate. If you use <code>control=list(allow.degen=TRUE)</code>, the EM algorithm will attempt to set the degenerate variances to zero (instead of trying to get to zero using an infinite number of iterations). However, if one of the variances is going to zero, first think about why this is happening. This is typically caused by one of three problems: 1) you made a mistake in inputting your data, e.g. used -99 as the missing value in your data but did not replace these with NAs before passing to MARSS, 2) your data are not sufficient to estimate multiple variances or 3) your data are inconsistent with the model you are trying fit.</p>
<p>The algorithms in the <strong>MARSS</strong> package are designed for cases where the <span class="math inline">\(\mathbf{Q}\)</span> and <span class="math inline">\(\mathbf{R}\)</span> diagonals are all non-minuscule. For example, the EM update equation for <span class="math inline">\(\mathbf{u}\)</span> will grind to a halt (not update <span class="math inline">\(\mathbf{u}\)</span>) if <span class="math inline">\(\mathbf{Q}\)</span> is tiny (like 1E-7). Conversely, the BFGS equations are likely to miss the maximum-likelihood when <span class="math inline">\(\mathbf{R}\)</span> is tiny because then the likelihood surface becomes hyper-sensitive to <span class="math inline">\(\boldsymbol{\pi}\)</span>. The solution is to use the degenerate likelihood function for the likelihood calculation and the EM update equations. <strong>MARSS</strong> will implement this automatically when <span class="math inline">\(\mathbf{Q}\)</span> or <span class="math inline">\(\mathbf{R}\)</span> diagonal elements are set to zero and will try setting <span class="math inline">\(\mathbf{Q}\)</span> and <span class="math inline">\(\mathbf{R}\)</span> terms to zero automatically if <code>control$allow.degen=TRUE</code>.</p>
<p>One odd case can occur when <span class="math inline">\(\mathbf{R}\)</span> goes to zero (a matrix of zeros), but you are estimating <span class="math inline">\(\boldsymbol{\pi}\)</span>. If <code>model$tinitx=1</code>, then <span class="math inline">\(\boldsymbol{\pi}=\mathbf{x}_1^0\)</span> and <span class="math inline">\(\mathbf{y}_1-\mathbf{Z}\mathbf{x}_1^0\)</span> can go to 0 as well as <span class="math inline">\(\,\text{var}(\mathbf{y}_1-\mathbf{Z}\mathbf{x}_1^0)\)</span> by driving <span class="math inline">\(\mathbf{R}\)</span> to zero. But as this happens, the log-likelihood associated with <span class="math inline">\(\mathbf{y}_1\)</span> will go (correctly) to infinity and thus the log-likelihood goes to infinity. But if you set <span class="math inline">\(\mathbf{R}=0\)</span>, the log-likelihood will be finite. The reason is that <span class="math inline">\(\mathbf{R} \approx 0\)</span> and <span class="math inline">\(\mathbf{R}=0\)</span> specify different likelihoods associated with <span class="math inline">\(\mathbf{y}_1-\mathbf{Z}\mathbf{x}_1^0\)</span>. With <span class="math inline">\(\mathbf{R}=0\)</span>, <span class="math inline">\(\mathbf{y}_1-\mathbf{Z}\mathbf{x}_1^0\)</span> does not have a distribution; it is just a fixed value. So there is no likelihood to go to infinity. If some elements of the diagonal of <span class="math inline">\(\mathbf{R}\)</span> are going to zero, you should be suspect of the parameter estimates. Sometimes the structure of your data, e.g. one data value followed by a long string of missing values, is causing an odd spike in the likelihood at <span class="math inline">\(\mathbf{R} \approx 0\)</span>. Try manually setting <span class="math inline">\(\mathbf{R}\)</span> equal to zero to get the correct log-likelihood. The likelihood returned when <span class="math inline">\(\mathbf{R} \approx 0\)</span> is not incorrect. It is just not the likelihood that you probably want. You want the likelihood where the <span class="math inline">\(\mathbf{R}\)</span> term is dropped because it is zero.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="part4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-algorithm-notes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/nwfsc-timeseries/MARSS-Manual/blob/master/cleanedRmd/09-troubleshooting.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MARSS_Manual.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
